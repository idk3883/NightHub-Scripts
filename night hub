-- ðŸŒ™ Night Hub 2.0 (Single Script Version)
-- Place in ServerScriptService

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Create Remote Folder Automatically
local remoteFolder = Instance.new("Folder")
remoteFolder.Name = "NightHubRemotes"
remoteFolder.Parent = ReplicatedStorage

local function newRemote(name)
	local r = Instance.new("RemoteEvent")
	r.Name = name
	r.Parent = remoteFolder
	return r
end

local SetPosition = newRemote("SetPosition")
local TeleportToSaved = newRemote("TeleportToSaved")
local TeleportToPlayer = newRemote("TeleportToPlayer")
local ToggleNoclip = newRemote("ToggleNoclip")

local savedPositions = {}

-- Server Logic
SetPosition.OnServerEvent:Connect(function(player)
	if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
		savedPositions[player] = player.Character.HumanoidRootPart.CFrame
	end
end)

TeleportToSaved.OnServerEvent:Connect(function(player)
	if savedPositions[player] and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
		player.Character.HumanoidRootPart.CFrame = savedPositions[player]
	end
end)

TeleportToPlayer.OnServerEvent:Connect(function(player, targetName)
	local target = Players:FindFirstChild(targetName)
	if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
		player.Character.HumanoidRootPart.CFrame =
			target.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,-3)
	end
end)

ToggleNoclip.OnServerEvent:Connect(function(player, state)
	if player.Character then
		for _, part in pairs(player.Character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = not state
			end
		end
	end
end)

Players.PlayerRemoving:Connect(function(player)
	savedPositions[player] = nil
end)

-- GUI Builder Function
local function createGui(player)

	local gui = Instance.new("ScreenGui")
	gui.Name = "NightHub"
	gui.ResetOnSpawn = false
	gui.Parent = player:WaitForChild("PlayerGui")

	-- Toggle Button
	local toggle = Instance.new("TextButton", gui)
	toggle.Size = UDim2.new(0,50,0,50)
	toggle.Position = UDim2.new(0,20,0,250)
	toggle.Text = "ðŸŒ™"
	toggle.TextScaled = true
	toggle.BackgroundColor3 = Color3.fromRGB(20,20,20)
	Instance.new("UICorner", toggle).CornerRadius = UDim.new(1,0)
	Instance.new("UIStroke", toggle).Color = Color3.new(1,1,1)

	-- Main Frame
	local main = Instance.new("Frame", gui)
	main.Size = UDim2.new(0,0,0,0)
	main.Position = UDim2.new(0.5,-225,0.5,-180)
	main.BackgroundColor3 = Color3.fromRGB(25,25,25)
	main.Visible = false
	main.Active = true
	main.Draggable = true
	Instance.new("UICorner", main).CornerRadius = UDim.new(0,15)
	Instance.new("UIStroke", main).Color = Color3.new(1,1,1)

	local open = false

	toggle.MouseButton1Click:Connect(function()
		open = not open
		if open then
			main.Visible = true
			TweenService:Create(main,TweenInfo.new(0.25),{Size = UDim2.new(0,450,0,360)}):Play()
		else
			local t = TweenService:Create(main,TweenInfo.new(0.25),{Size = UDim2.new(0,0,0,0)})
			t:Play()
			t.Completed:Connect(function()
				main.Visible = false
			end)
		end
	end)

	local function makeButton(text,y)
		local b = Instance.new("TextButton", main)
		b.Size = UDim2.new(0,220,0,40)
		b.Position = UDim2.new(0.5,-110,0,y)
		b.Text = text
		b.TextScaled = true
		b.BackgroundColor3 = Color3.fromRGB(35,35,35)
		Instance.new("UICorner", b).CornerRadius = UDim.new(0,10)
		Instance.new("UIStroke", b).Color = Color3.new(1,1,1)
		return b
	end

	-- Speed Box
	local speedBox = Instance.new("TextBox", main)
	speedBox.Size = UDim2.new(0,220,0,40)
	speedBox.Position = UDim2.new(0.5,-110,0,40)
	speedBox.PlaceholderText = "Set Speed"
	speedBox.TextScaled = true
	speedBox.BackgroundColor3 = Color3.fromRGB(35,35,35)
	Instance.new("UICorner", speedBox)
	Instance.new("UIStroke", speedBox).Color = Color3.new(1,1,1)

	speedBox.FocusLost:Connect(function()
		local num = tonumber(speedBox.Text)
		if num and player.Character and player.Character:FindFirstChild("Humanoid") then
			player.Character.Humanoid.WalkSpeed = num
		end
	end)

	-- Noclip
	local noclip = false
	makeButton("Toggle Noclip",100).MouseButton1Click:Connect(function()
		noclip = not noclip
		ToggleNoclip:FireServer(noclip)
	end)

	-- Teleports
	makeButton("Set Position",160).MouseButton1Click:Connect(function()
		SetPosition:FireServer()
	end)

	makeButton("Teleport To Saved",220).MouseButton1Click:Connect(function()
		TeleportToSaved:FireServer()
	end)

	local tpBox = Instance.new("TextBox", main)
	tpBox.Size = UDim2.new(0,220,0,40)
	tpBox.Position = UDim2.new(0.5,-110,0,280)
	tpBox.PlaceholderText = "Teleport To Player"
	tpBox.TextScaled = true
	tpBox.BackgroundColor3 = Color3.fromRGB(35,35,35)
	Instance.new("UICorner", tpBox)
	Instance.new("UIStroke", tpBox).Color = Color3.new(1,1,1)

	tpBox.FocusLost:Connect(function(enter)
		if enter then
			TeleportToPlayer:FireServer(tpBox.Text)
		end
	end)

	makeButton("Leave Game",340).MouseButton1Click:Connect(function()
		player:Kick("You left Night Hub.")
	end)

end

-- Give GUI to Players
Players.PlayerAdded:Connect(function(player)
	player.CharacterAdded:Wait()
	createGui(player)
end)
