local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

player.CharacterAdded:Connect(function(char)
	character = char
	humanoid = character:WaitForChild("Humanoid")
end)

-- STATES
local infiniteJump = false
local noclipEnabled = false
local espEnabled = false

-- GUI
local gui = Instance.new("ScreenGui")
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

-- OPEN BUTTON
local openButton = Instance.new("TextButton")
openButton.Size = UDim2.fromScale(0.05,0.08)
openButton.Position = UDim2.fromScale(0.02,0.4)
openButton.Text = "üåô"
openButton.TextScaled = true
openButton.BackgroundColor3 = Color3.fromRGB(20,20,20)
openButton.TextColor3 = Color3.new(1,1,1)
openButton.Parent = gui
Instance.new("UICorner", openButton).CornerRadius = UDim.new(0,12)
Instance.new("UIStroke", openButton).Color = Color3.new(1,1,1)

-- MAIN FRAME
local main = Instance.new("Frame")
main.Size = UDim2.fromScale(0.45,0.5)
main.Position = UDim2.fromScale(0.28,0.25)
main.BackgroundColor3 = Color3.fromRGB(20,20,20)
main.Visible = false
main.Parent = gui
main.Active = true
Instance.new("UICorner", main).CornerRadius = UDim.new(0,14)
Instance.new("UIStroke", main).Color = Color3.new(1,1,1)

openButton.MouseButton1Click:Connect(function()
	main.Visible = not main.Visible
end)

-- DRAGGING
local dragging, dragStart, startPos

main.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = main.Position
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
		local delta = input.Position - dragStart
		main.Position = UDim2.new(
			startPos.X.Scale,
			startPos.X.Offset + delta.X,
			startPos.Y.Scale,
			startPos.Y.Offset + delta.Y
		)
	end
end)

UserInputService.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = false
	end
end)

-- SIDEBAR
local sidebar = Instance.new("Frame")
sidebar.Size = UDim2.fromScale(0.3,1)
sidebar.BackgroundColor3 = Color3.fromRGB(25,25,25)
sidebar.Parent = main
Instance.new("UIStroke", sidebar).Color = Color3.new(1,1,1)

local pages = Instance.new("Frame")
pages.Size = UDim2.fromScale(0.7,1)
pages.Position = UDim2.fromScale(0.3,0)
pages.BackgroundTransparency = 1
pages.Parent = main

local function createPage()
	local frame = Instance.new("Frame")
	frame.Size = UDim2.fromScale(1,1)
	frame.BackgroundTransparency = 1
	frame.Visible = false
	frame.Parent = pages
	return frame
end

local speedPage = createPage()
local jumpPage = createPage()
local noclipPage = createPage()
local espPage = createPage()

local function switchPage(page)
	for _,v in pairs(pages:GetChildren()) do
		if v:IsA("Frame") then
			v.Visible = false
		end
	end
	page.Visible = true
end

-- SIDEBAR BUTTON CREATOR
local function sidebarButton(text, order, page)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.fromScale(1,0.15)
	btn.Position = UDim2.fromScale(0,order)
	btn.Text = text
	btn.TextScaled = true
	btn.BackgroundColor3 = Color3.fromRGB(30,30,30)
	btn.TextColor3 = Color3.new(1,1,1)
	btn.Parent = sidebar
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0,8)
	Instance.new("UIStroke", btn).Color = Color3.new(1,1,1)
	btn.MouseButton1Click:Connect(function()
		switchPage(page)
	end)
end

sidebarButton("‚ö° Speed",0,speedPage)
sidebarButton("ü¶ò Jump",0.16,jumpPage)
sidebarButton("üî• Noclip",0.32,noclipPage)
sidebarButton("üëÅ ESP",0.48,espPage)

-- SPEED PAGE
local speedBox = Instance.new("TextBox")
speedBox.Size = UDim2.fromScale(0.8,0.15)
speedBox.Position = UDim2.fromScale(0.1,0.1)
speedBox.PlaceholderText = "‚ö° Set Speed"
speedBox.TextScaled = true
speedBox.BackgroundColor3 = Color3.fromRGB(30,30,30)
speedBox.TextColor3 = Color3.new(1,1,1)
speedBox.Parent = speedPage
Instance.new("UICorner", speedBox).CornerRadius = UDim.new(0,10)
Instance.new("UIStroke", speedBox).Color = Color3.new(1,1,1)

speedBox.FocusLost:Connect(function()
	local num = tonumber(speedBox.Text)
	if num and humanoid then
		humanoid.WalkSpeed = math.clamp(num,0,300)
	end
end)

-- JUMP PAGE
local jumpBtn = Instance.new("TextButton")
jumpBtn.Size = UDim2.fromScale(0.8,0.15)
jumpBtn.Position = UDim2.fromScale(0.1,0.1)
jumpBtn.Text = "ü¶ò Infinite Jump: OFF"
jumpBtn.TextScaled = true
jumpBtn.BackgroundColor3 = Color3.fromRGB(30,30,30)
jumpBtn.TextColor3 = Color3.new(1,1,1)
jumpBtn.Parent = jumpPage
Instance.new("UICorner", jumpBtn).CornerRadius = UDim.new(0,10)
Instance.new("UIStroke", jumpBtn).Color = Color3.new(1,1,1)

UserInputService.JumpRequest:Connect(function()
	if infiniteJump and humanoid then
		humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
	end
end)

jumpBtn.MouseButton1Click:Connect(function()
	infiniteJump = not infiniteJump
	jumpBtn.Text = infiniteJump and "ü¶ò Infinite Jump: ON" or "ü¶ò Infinite Jump: OFF"
end)

-- NOCLIP
RunService.Stepped:Connect(function()
	if noclipEnabled and character then
		for _,part in pairs(character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
			end
		end
	end
end)

local noclipBtn = Instance.new("TextButton")
noclipBtn.Size = UDim2.fromScale(0.8,0
